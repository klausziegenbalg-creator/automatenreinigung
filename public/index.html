<head>
  <meta charset="UTF-8" />
  <title>Reiniger App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 16px;
      max-width: 600px;
      margin: auto;
      background:
        radial-gradient(circle at 20% 15%, rgba(120, 165, 255, 0.35), transparent 45%),
        radial-gradient(circle at 80% 0%, rgba(160, 200, 255, 0.28), transparent 40%),
        linear-gradient(135deg, #f6f9ff, #e7f0ff);
      min-height: 100vh;
      color: #1f1b1b;
      animation: glowShift 14s ease-in-out infinite;
    }

    h1 { font-size: 28px; margin-bottom: 12px; }
    h3 { margin: 0; }

    input, select, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      font-size: 16px;
      box-sizing: border-box;
      border-radius: 12px;
      border: 1px solid rgba(140, 160, 200, 0.35);
      background: rgba(255, 255, 255, 0.85);
      transition: box-shadow 0.2s ease, border-color 0.2s ease;
    }

    label {
      display: block;
      margin-top: 0;
      font-weight: 500;
    }

    .box {
      border-top: 1px solid rgba(170, 190, 220, 0.35);
      margin-top: 20px;
      padding-top: 16px;
      background: rgba(255, 255, 255, 0.65);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(60, 90, 140, 0.08);
      backdrop-filter: blur(6px);
    }

    .status {
      margin-top: 10px;
      min-height: 22px;
      font-weight: bold;
    }

    .error-details {
      font-weight: 500;
      color: #8b1d1d;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .last {
      margin-top: 12px;
      font-size: 14px;
      color: #333;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
      margin-top: 16px;
      padding: 6px 0;
    }

    .arrow {
      font-size: 18px;
      width: 24px;
      text-align: right;
    }

    /* TASK */
    .task {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      padding: 8px 10px;
      border: 1px solid rgba(160, 180, 210, 0.35);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.75);
      cursor: pointer;
    }

    .task input[type="checkbox"] {
      width: auto;
      margin: 0;
      pointer-events: none;
    }

    .bestaende-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 8px;
    }

    .bestaende-item {
      padding: 10px;
      border: 1px solid rgba(160, 180, 210, 0.35);
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.75);
    }

    .order-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 8px;
    }

    .order-btn {
      padding: 14px;
      border-radius: 10px;
      border: 1px solid rgba(160, 180, 210, 0.4);
      background: #ffffff;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(60, 90, 140, 0.08);
    }

    .order-btn.is-selected {
      border-color: rgba(60, 110, 200, 0.7);
      box-shadow: 0 10px 22px rgba(70, 120, 200, 0.2);
      background: rgba(230, 240, 255, 0.9);
    }

    .photo-box {
      margin-top: 6px;
      font-size: 14px;
    }

    .lang-switch {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .lang-btn {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(130, 160, 200, 0.45);
      background: rgba(255, 255, 255, 0.85);
      font-size: 14px;
      cursor: pointer;
      width: auto;
    }

    .lang-btn.active {
      background: rgba(210, 225, 255, 0.9);
      border-color: rgba(90, 130, 210, 0.7);
      font-weight: 600;
    }

    button {
      background: #ffffff;
      border: 1px solid rgba(130, 160, 200, 0.45);
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(70, 110, 160, 0.12);
    }

    button:hover {
      border-color: rgba(110, 145, 200, 0.55);
      box-shadow: 0 10px 22px rgba(80, 120, 180, 0.16);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: rgba(90, 130, 210, 0.7);
      box-shadow: 0 0 0 3px rgba(120, 160, 255, 0.18);
    }

    @keyframes glowShift {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    /* ===== FIX 1 ‚Äì STATUS & BUTTON FEEDBACK ===== */

    #wochenStatus {
      margin-top: 10px;
      min-height: 22px;
      font-weight: bold;
    }

    #btnWochenwartung.success {
      background: #2e7d32 !important;
      border-color: #2e7d32 !important;
      color: #ffffff !important;
    }

    #btnWochenwartung.error {
      background: #c62828 !important;
      border-color: #c62828 !important;
      color: #ffffff !important;
    }
  </style>
</head>


<body>

<div class="lang-switch" aria-label="Sprache w√§hlen">
  <button type="button" class="lang-btn" data-lang="de">DE</button>
  <button type="button" class="lang-btn" data-lang="en">EN</button>
  <button type="button" class="lang-btn" data-lang="tr">TR</button>
  <button type="button" class="lang-btn" data-lang="ar">AR</button>
</div>

<h1 data-i18n="title">Reiniger App</h1>

<input id="pin" data-i18n-placeholder="pin_placeholder" placeholder="PIN eingeben" />
<button onclick="login()" data-i18n="login">Login</button>
<div id="status" class="status"></div>
<div id="errorDetails" class="status error-details"></div>

<div class="box">
  <label data-i18n="city">Stadt</label>
  <select id="stadtSelect"><option>‚Äì bitte einloggen ‚Äì</option></select>
  <label data-i18n="center">Center</label>
  <select id="centerSelect"><option>‚Äì bitte einloggen ‚Äì</option></select>
  <label data-i18n="machine">Automat</label>
  <select id="automatSelect"><option>‚Äì bitte einloggen ‚Äì</option></select>
</div>

<div id="lastCleaning" class="last"></div>

<div id="cleaningForm" class="box" style="display:none">

  <label for="datum" data-i18n="date">Datum</label>
  <input type="date" id="datum" />

  <!-- 2. Aufgaben -->
  <div class="section-header" onclick="toggleSection('sec2', this)">
    <h3 data-i18n="sec2">2. Aufgaben pro Automat</h3><div class="arrow">‚ñº</div>
  </div>
  <div id="sec2" style="display:none">
    <label class="task"><input type="checkbox" id="zucker"><span data-i18n="chk_zucker">Zucker aufgef√ºllt</span></label>
    <label class="task"><input type="checkbox" id="wasser"><span data-i18n="chk_wasser">Wasser aufgef√ºllt</span></label>
    <label class="task"><input type="checkbox" id="staebeAuf"><span data-i18n="chk_staebeAuf">St√§be aufgef√ºllt</span></label>
    <label class="task"><input type="checkbox" id="zuckerfach"><span data-i18n="chk_zuckerfach">Zuckerfach gereinigt</span></label>
    <label class="task"><input type="checkbox" id="faecher"><span data-i18n="chk_faecher">Alle F√§cher gereinigt</span></label>
    <label class="task"><input type="checkbox" id="abwasser"><span data-i18n="chk_abwasser">Abwasser entleert</span></label>
    <label class="task"><input type="checkbox" id="produktionsraum"><span data-i18n="chk_produktionsraum">Produktionsraum gereinigt</span></label>
    <label class="task"><input type="checkbox" id="messer"><span data-i18n="chk_messer">Messer + R√§dchen gereinigt</span></label>
    <label class="task"><input type="checkbox" id="roboterarm"><span data-i18n="chk_roboterarm">Roboterarm gr√ºndlich gereinigt</span></label>
    <label class="task"><input type="checkbox" id="sieb"><span data-i18n="chk_sieb">Sieb oben gereinigt</span></label>
    <label class="task"><input type="checkbox" id="auffangschale"><span data-i18n="chk_auffangschale">Auffangschale gereinigt</span></label>
    <label class="task"><input type="checkbox" id="aufbewahrung"><span data-i18n="chk_aufbewahrung">Aufbewahrungsfach aufger√§umt</span></label>
    <label class="task"><input type="checkbox" id="aussen"><span data-i18n="chk_aussen">Automat au√üen gereinigt</span></label>
    <label class="task"><input type="checkbox" id="scheiben"><span data-i18n="chk_scheiben">Scheiben gereinigt</span></label>
    <label class="task"><input type="checkbox" id="brennerkopf"><span data-i18n="chk_brennerkopf">Brennerkopf gereinigt</span></label>
    <label class="task"><input type="checkbox" id="duese"><span data-i18n="chk_duese">D√ºse hinter Brennerkopf gereinigt</span></label>
  </div>

  <!-- 3. Funktionspr√ºfung -->
  <div class="section-header" onclick="toggleSection('sec3', this)">
    <h3 data-i18n="sec3">3. Funktionspr√ºfung</h3><div class="arrow">‚ñº</div>
  </div>
  <div id="sec3" style="display:none">
    <label class="task"><input type="checkbox" id="befeuchtung"><span data-i18n="chk_befeuchtung">Befeuchtungstest</span></label>
    <label class="task"><input type="checkbox" id="reinigungstest"><span data-i18n="chk_reinigungstest">Reinigungstest</span></label>
    <label class="task"><input type="checkbox" id="neuer_stab"><span data-i18n="chk_neuer_stab">Neuen Stab genommen</span></label>
    <label class="task"><input type="checkbox" id="roboterarm_90grad"><span data-i18n="chk_roboterarm_90grad">Roboterarm im 90¬∞-Winkel</span></label>
    <label class="task"><input type="checkbox" id="kreditkarte_ok"><span data-i18n="chk_kreditkarte_ok">Kreditkartensystem OK</span></label>
    <label class="task"><input type="checkbox" id="geldschein_ok"><span data-i18n="chk_geldschein_ok">Geldschein-System OK</span></label>
    <label class="task"><input type="checkbox" id="material_eingetragen"><span data-i18n="chk_material_eingetragen">Material im System eingetragen</span></label>
    <label data-i18n="notes">Auff√§lligkeiten</label>
    <textarea id="auffaelligkeiten"></textarea>
  </div>

  <!-- 4. Best√§nde (unver√§ndert) -->
  <div class="section-header" onclick="toggleSection('sec4', this)">
    <h3 data-i18n="sec4">4. Best√§nde</h3><div class="arrow">‚ñº</div>
  </div>
  <div id="sec4" style="display:none">
    <div class="bestaende-grid">
      <div class="bestaende-item"><label data-i18n="stock_red">Roter Zucker</label><input type="number" step="0.5" id="zucker_rot"></div>
      <div class="bestaende-item"><label data-i18n="stock_yellow">Gelber Zucker</label><input type="number" step="0.5" id="zucker_gelb"></div>
      <div class="bestaende-item"><label data-i18n="stock_blue">Blauer Zucker</label><input type="number" step="0.5" id="zucker_blau"></div>
      <div class="bestaende-item"><label data-i18n="stock_white">Wei√üer Zucker</label><input type="number" step="0.5" id="zucker_weiss"></div>
      <div class="bestaende-item"><label data-i18n="stock_sticks">St√§be (Pakete)</label><input type="number" step="0.5" id="staebe"></div>
    </div>
  </div>

  <!-- 5. Bestellungen (unver√§ndert) -->
  <div class="section-header" onclick="toggleSection('sec5', this)">
    <h3 data-i18n="sec5">5. Bestellungen</h3><div class="arrow">‚ñº</div>
  </div>
  <div id="sec5" style="display:none">
    <div class="order-grid">
      <button class="order-btn" data-order="rot" data-i18n="order_red">üçì Rot</button>
      <button class="order-btn" data-order="gelb" data-i18n="order_yellow">üç≠ Gelb</button>
      <button class="order-btn" data-order="blau" data-i18n="order_blue">ü´ê Blau</button>
      <button class="order-btn" data-order="weiss" data-i18n="order_white">üç≠ Wei√ü</button>
      <button class="order-btn" data-order="staebe" data-i18n="order_sticks">üßä St√§be</button>
    </div>
    <div id="orderStatus" class="status"></div>
  </div>

  <!-- 6. Wochenwartung -->
  <!-- 6. Wochenwartung -->
<div class="section-header" onclick="toggleSection('sec6', this)">
  <h3 data-i18n="sec6">6. Wochenwartung</h3>
  <div class="arrow">‚ñº</div>
</div>

<div id="sec6" style="display:none">

  <label class="task">
    <input type="checkbox" id="wk_brennerkopf_oeffnen">
    <span>Brennerkopf reinigen & √∂ffnen</span>
  </label>
  <div class="photo-box">
    <input type="file" accept="image/*" capture="environment" data-task-id="wk_brennerkopf_oeffnen">
  </div>

  <label class="task">
    <input type="checkbox" id="wk_wasserbehaelter_reinigen">
    <span>Wasserbeh√§lter Frischwasser leeren und reinigen</span>
  </label>
  <div class="photo-box">
    <input type="file" accept="image/*" capture="environment" data-task-id="wk_wasserbehaelter_reinigen">
  </div>

  <label class="task">
    <input type="checkbox" id="wk_entkalkung_frischwasser">
    <span>Entkalkung der Frischwasseranlage</span>
  </label>
  <div class="photo-box">
    <input type="file" accept="image/*" capture="environment" data-task-id="wk_entkalkung_frischwasser">
  </div>

  <label class="task">
    <input type="checkbox" id="wk_brenner_rundum">
    <span>Brenner rund herum reinigen</span>
  </label>
  <div class="photo-box">
    <input type="file" accept="image/*" capture="environment" data-task-id="wk_brenner_rundum">
  </div>

  <button
    type="button"
    id="btnWochenwartung"
    onclick="saveWochenWartung()">
    <span data-i18n="save_weekly">Wochenwartung speichern</span>
  </button>

  <div id="wochenStatus" class="status"></div>
</div>


  <!-- 7. Wartung (unver√§ndert) -->
  <div class="section-header" onclick="toggleSection('sec7', this); onWartungToggle();">
    <h3 data-i18n="sec7">7. Reparaturen / Wartung</h3><div class="arrow">‚ñº</div>
  </div>
  <div id="sec7" style="display:none">
    <label for="wartungSelect" data-i18n="maintenance_element">Wartungselement (optional)</label>
    <select id="wartungSelect" disabled>
      <option value="">‚Äì wird geladen ‚Ä¶ ‚Äì</option>
    </select>

    <label for="wartungFreitext" data-i18n="maintenance_free">oder Freitext (optional)</label>
    <input id="wartungFreitext" type="text"/>

    <label for="wartungBemerkung" data-i18n="maintenance_notes">Bemerkungen</label>
    <textarea id="wartungBemerkung"></textarea>

    <label for="wartungFoto" data-i18n="maintenance_photo">Foto (optional)</label>
    <input id="wartungFoto" type="file" accept="image/*" capture="environment" />

    <button type="button" onclick="saveWartung()" data-i18n="save_maintenance">Wartung speichern</button>
    <div id="wartungStatus" class="status"></div>
  </div>

  <label data-i18n="comment">Bemerkung</label>
  <textarea id="bemerkung"></textarea>

  <button onclick="saveCleaning()" data-i18n="save_cleaning">Reinigung speichern</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-storage-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBo-pt3krDP9c5AxojmWaHVqPkoqmupOvA",
    authDomain: "digitales-bordbuch.firebaseapp.com",
    projectId: "digitales-bordbuch",
    storageBucket: "digitales-bordbuch.appspot.com",
    messagingSenderId: "612073997080",
    appId: "1:612073997080:web:762a85694716da8f84546d",
    measurementId: "G-VRX8Q8QNDH"
  };

  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }

  window.storage = firebase.storage();
</script>

<!-- App-Logik -->
<script src="app.js"></script>
<script src="i18n.js"></script>

<!-- UI-Helfer GANZ ZUM SCHLUSS -->
<script>
function toggleSection(id, header) {
  const section = document.getElementById(id);
  if (!section) return;

  const arrow = header.querySelector('.arrow');
  const isOpen = section.style.display === 'block';

  section.style.display = isOpen ? 'none' : 'block';
  if (arrow) arrow.textContent = isOpen ? '‚ñº' : '‚ñ≤';
}
</script>

</body>
</html>
